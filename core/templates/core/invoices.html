<!-- Invoices Unallocated Section Template -->
<!-- Uses reusable allocations section with invoice-specific configuration -->

{% include "core/components/reusable_allocations_section.html" with section_id="invoice" main_table_columns=main_table_columns allocations_columns=allocations_columns allocations_title="Invoice Allocations" viewer_placeholder_text="Click on an invoice to view the PDF" viewer_placeholder_icon="fas fa-file-pdf" %}

<!-- Legacy CSS overrides - applied after ID remapping -->
<style>
    /* CSS for legacy IDs after remapping */
    #unallocatedInvoicesTable { font-size: 12px; }
    #unallocatedInvoicesTable th { padding: 6px 5px !important; font-size: 11px; white-space: nowrap; vertical-align: middle; }
    #unallocatedInvoicesTable td { padding: 4px 5px !important; vertical-align: middle; }
    #unallocatedInvoicesTable .form-control-sm { font-size: 11px; padding: 3px 5px; height: 28px; min-height: 28px; }
    #unallocatedInvoicesTable input[type="text"], #unallocatedInvoicesTable input[type="number"] { font-size: 11px; padding: 3px 5px; height: 28px; }
    #unallocatedInvoicesTable tbody tr { cursor: pointer; transition: opacity 0.3s ease, box-shadow 0.3s ease; }
    #unallocatedInvoicesTable tbody.has-selection tr:not(.selected-row) { opacity: 0.4; }
    #unallocatedInvoicesTable tbody tr.selected-row { opacity: 1 !important; background-color: #e3f2fd !important; box-shadow: 0 0 10px rgba(33, 150, 243, 0.3); position: relative; }
    #unallocatedInvoicesTable tbody tr:hover { opacity: 0.8 !important; }
</style>

<!-- Legacy ID mappings for backwards compatibility with existing JavaScript -->
<script>
(function() {
    // Map new template IDs to legacy IDs expected by existing JavaScript
    const idMappings = {
        'invoiceMainTable': 'unallocatedInvoicesTable',
        'invoiceMainTableBody': 'unallocatedInvoicesTableBody',
        'invoiceMainTableFooter': 'unallocatedInvoicesTableFooter',
        'invoiceTableContainer': 'invoicesTableContainer',
        'invoiceAddAllocationBtn': 'addInvoiceAllocationBtn',
        'invoiceFooterCol3': 'unallocatedInvoicesNetTotal',
        'invoiceFooterCol4': 'unallocatedInvoicesGstTotal'
    };
    
    // Rename IDs for backwards compatibility
    Object.entries(idMappings).forEach(([templateId, legacyId]) => {
        const element = document.getElementById(templateId);
        if (element) {
            element.id = legacyId;
        }
    });
})();
</script>
