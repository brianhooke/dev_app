{% load static %}
{% load humanize %}

<style>
  .reusable-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    font-size: 12px;
    border-radius: 8px;
    overflow: hidden;
  }
  
  .reusable-table th {
    padding: 6px 6px;
    text-align: left;
    font-weight: bold;
    font-size: 14px;
    background: var(--gradient-primary);
    color: white;
    white-space: nowrap;
    line-height: 1.2;
    position: sticky;
    top: 0;
    z-index: 10;
  }
  
  .reusable-table thead tr:first-child th:first-child {
    border-top-left-radius: 8px;
  }
  
  .reusable-table thead tr:first-child th:last-child {
    border-top-right-radius: 8px;
  }
  
  .reusable-table tbody tr {
    border-bottom: 1px solid #e0e0e0;
    transition: background-color 0.2s;
  }
  
  .reusable-table tbody tr:hover {
    background-color: #f5f5f5;
  }
  
  .reusable-table tbody tr.category-row {
    cursor: pointer;
    background-color: #f9f9f9;
    font-weight: 600;
  }
  
  .reusable-table tbody tr.category-row:hover {
    background-color: #ececec;
  }
  
  .reusable-table td {
    padding: 4px 6px;
    border-bottom: 1px solid #e0e0e0;
    line-height: 1.3;
    vertical-align: middle;
  }
  
  /* Compact buttons in reusable tables */
  .reusable-table .btn-sm {
    padding: 3px 8px !important;
    font-size: 11px !important;
    line-height: 1.2 !important;
    min-height: 26px !important;
    height: 26px !important;
  }
  
  .reusable-table .btn-sm i {
    font-size: 12px;
  }
  
  .reusable-table .dropdown-arrow {
    display: inline-block;
    margin-left: 5px;
    transition: transform 0.3s ease;
  }
  
  .reusable-table .dropdown-arrow.rotated {
    transform: rotate(-90deg);
  }
  
  {% if show_totals %}
  .reusable-table #totalRow {
    background: var(--gradient-primary);
    color: white;
    font-weight: bold;
  }
  
  .reusable-table #totalRow td:first-child {
    border-bottom-left-radius: 8px;
  }
  
  .reusable-table #totalRow td:last-child {
    border-bottom-right-radius: 8px;
  }
  {% endif %}
</style>

<table class="reusable-table">
    <thead>
      <tr>
        {% for column in columns %}
          <th>{{ column }}</th>
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      {% if rows %}
        {% for row in rows %}
          <tr {% if row.is_category %}class="category-row" data-toggle="collapse" data-target=".group{{ forloop.counter }}"{% endif %}>
            {% for cell in row.cells %}
              <td>
                {% if row.is_category and forloop.first %}
                  <strong>{{ cell }}</strong>
                  <span class="dropdown-arrow">â–¼</span>
                {% else %}
                  {{ cell }}
                {% endif %}
              </td>
            {% endfor %}
          </tr>
        {% endfor %}
      {% else %}
        <tr>
          <td colspan="{{ columns|length }}" style="text-align: center; padding: 20px; color: #999;">
            No data available
          </td>
        </tr>
      {% endif %}
      
      {% if show_totals and totals %}
        <tr id="totalRow">
          {% for total in totals %}
            <td>{{ total }}</td>
          {% endfor %}
        </tr>
      {% endif %}
    </tbody>
</table>
